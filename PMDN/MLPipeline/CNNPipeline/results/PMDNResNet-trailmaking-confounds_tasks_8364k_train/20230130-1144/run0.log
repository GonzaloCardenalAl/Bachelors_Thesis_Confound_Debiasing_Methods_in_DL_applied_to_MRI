START_TIME 	 11:44::47
dataset loaded successfully in 21m:35s..
Starting CNN_PIPELINE() with:                
{'run_id': 'run0', 'model': 'PMDNResNet50DeepRepViz', 'model_params': {'dataset_size': 8364, 'batch_size': 24, 'task_type': 'classif_binary', 'out_classes': 1, 'debug_print': True, 'pretrained_model': '/ritter/share/data/UKBB_2020/trained_model/r3d50_K_200ep.pth'}, 'model_unique_name': 'PMDN_trailmaking', 'inp': 'X', 'out': 'trail_making_avg_duration', 'n_samples': 8364, 'm__batch_size': 24, 'm__num_epochs': 120, 'm__criterion': 'MSELoss({})', 'm__optimizer': "Adam({'lr': 0.0005, 'weight_decay': 0.0001})", 'm__scheduler': "StepLR({'step_size': 20, 'gamma': 0.1})", 'm__augmentations': ['SagittalFlip', 'SagittalTranslate'], 'm__earlystop_patience': 15}                
output_dir: /ritter/share/projects/gonzalo/thesis/PMDN/MLPipeline/CNNPipeline/results//PMDNResNet-trailmaking-confounds_tasks_8364k_train/20230130-1144                
using GPU:  cuda:1                 
---------------- CNNpipeline starting ----------------
###############hi############
:: m__n_params:    47122385
[0,    58] loss: 0.03432
[0,    58] beta loss: 3278238.66102
[0,   116] loss: 0.02644
[0,   116] beta loss: 3099169.08120
[0,   174] loss: 0.02231
[0,   174] beta loss: 3083236.21143
Time elapsed: 0h:5m:38s
train explained_variance_score: -96.61 %
val loss: 0.01272
val explained_variance_score: 0.17 %
[1,    58] loss: 0.01317
[1,    58] beta loss: 2874161.38136
[1,   116] loss: 0.01394
[1,   116] beta loss: 2938509.55769
[1,   174] loss: 0.01356
[1,   174] beta loss: 2930059.37857
Time elapsed: 0h:11m:54s
train explained_variance_score: -6.75 %
val loss: 0.01295
val explained_variance_score: 2.70 %
[2,    58] loss: 0.01359
[2,    58] beta loss: 2966710.08051
[2,   116] loss: 0.01307
[2,   116] beta loss: 2951949.00855
[2,   174] loss: 0.01326
[2,   174] beta loss: 2974789.59143
Time elapsed: 0h:18m:6s
train explained_variance_score: 4.43 %
val loss: 0.01612
val explained_variance_score: -9.32 %
[3,    58] loss: 0.01165
[3,    58] beta loss: 3145168.13136
[3,   116] loss: 0.01262
[3,   116] beta loss: 3047890.90171
[3,   174] loss: 0.01263
[3,   174] beta loss: 3037532.14714
Time elapsed: 0h:24m:18s
train explained_variance_score: -4.96 %
val loss: 0.01310
val explained_variance_score: -1.74 %
[4,    58] loss: 0.01273
[4,    58] beta loss: 3011507.94492
[4,   116] loss: 0.01222
[4,   116] beta loss: 3035428.96368
[4,   174] loss: 0.01245
[4,   174] beta loss: 3087495.76143
Time elapsed: 0h:30m:28s
train explained_variance_score: -2.23 %
val loss: 0.01315
val explained_variance_score: -2.01 %
[5,    58] loss: 0.01257
[5,    58] beta loss: 3072366.24153
[5,   116] loss: 0.01297
[5,   116] beta loss: 3058523.60684
[5,   174] loss: 0.01307
[5,   174] beta loss: 3059587.21286
Time elapsed: 0h:36m:40s
train explained_variance_score: 4.49 %
val loss: 0.01239
val explained_variance_score: 3.62 %
[6,    58] loss: 0.01414
[6,    58] beta loss: 3090435.29237
[6,   116] loss: 0.01310
[6,   116] beta loss: 3071468.60470
[6,   174] loss: 0.01260
[6,   174] beta loss: 3090765.43429
Time elapsed: 0h:42m:54s
train explained_variance_score: 1.90 %
val loss: 0.01376
val explained_variance_score: -2.22 %
[7,    58] loss: 0.01169
[7,    58] beta loss: 3091302.25847
[7,   116] loss: 0.01237
[7,   116] beta loss: 3109425.55556
[7,   174] loss: 0.01228
[7,   174] beta loss: 3100217.77429
Time elapsed: 0h:49m:21s
train explained_variance_score: -4.90 %
val loss: 0.01401
val explained_variance_score: 0.11 %
[8,    58] loss: 0.01374
[8,    58] beta loss: 3059220.00424
[8,   116] loss: 0.01306
[8,   116] beta loss: 3038439.87821
[8,   174] loss: 0.01270
[8,   174] beta loss: 3082902.05143
Time elapsed: 0h:57m:6s
train explained_variance_score: -0.05 %
val loss: 0.01230
val explained_variance_score: 3.70 %
[9,    58] loss: 0.01328
[9,    58] beta loss: 2987955.61017
[9,   116] loss: 0.01271
[9,   116] beta loss: 3026656.49359
[9,   174] loss: 0.01234
[9,   174] beta loss: 3044237.60286
Time elapsed: 1h:8m:16s
train explained_variance_score: 11.49 %
val loss: 0.01281
val explained_variance_score: -0.45 %
[10,    58] loss: 0.01070
[10,    58] beta loss: 2956014.80085
[10,   116] loss: 0.01177
[10,   116] beta loss: 3029497.49359
[10,   174] loss: 0.01158
[10,   174] beta loss: 3017460.94143
Time elapsed: 1h:16m:28s
train explained_variance_score: 8.30 %
val loss: 0.01291
val explained_variance_score: 5.98 %
[11,    58] loss: 0.01047
[11,    58] beta loss: 3001145.68644
[11,   116] loss: 0.01183
[11,   116] beta loss: 2999345.47222
[11,   174] loss: 0.01179
[11,   174] beta loss: 2989667.23429
Time elapsed: 1h:23m:30s
train explained_variance_score: 8.03 %
val loss: 0.01198
val explained_variance_score: 7.47 %
[12,    58] loss: 0.01134
[12,    58] beta loss: 3064991.10169
[12,   116] loss: 0.01109
[12,   116] beta loss: 3047364.79060
[12,   174] loss: 0.01170
[12,   174] beta loss: 3015457.26000
Time elapsed: 1h:30m:28s
train explained_variance_score: 7.17 %
val loss: 0.01217
val explained_variance_score: 6.26 %
[13,    58] loss: 0.01023
[13,    58] beta loss: 2937586.89831
[13,   116] loss: 0.01110
[13,   116] beta loss: 2917388.52350
[13,   174] loss: 0.01127
[13,   174] beta loss: 2918727.87286
Time elapsed: 1h:37m:27s
train explained_variance_score: 13.76 %
val loss: 0.01396
val explained_variance_score: 5.49 %
[14,    58] loss: 0.01109
[14,    58] beta loss: 2896870.52542
[14,   116] loss: 0.01122
[14,   116] beta loss: 2902153.89744
[14,   174] loss: 0.01114
[14,   174] beta loss: 2902488.38000
Time elapsed: 1h:43m:59s
train explained_variance_score: 17.33 %
val loss: 0.01207
val explained_variance_score: 6.32 %
[15,    58] loss: 0.01089
[15,    58] beta loss: 2899375.10169
[15,   116] loss: 0.01030
[15,   116] beta loss: 2874962.51496
[15,   174] loss: 0.01092
[15,   174] beta loss: 2913338.27571
Time elapsed: 1h:50m:43s
train explained_variance_score: 9.22 %
val loss: 0.01449
val explained_variance_score: 7.09 %
[16,    58] loss: 0.01049
[16,    58] beta loss: 2922367.90254
[16,   116] loss: 0.01100
[16,   116] beta loss: 2929625.30556
[16,   174] loss: 0.01130
[16,   174] beta loss: 2921288.19429
Time elapsed: 1h:57m:8s
train explained_variance_score: 29.97 %
val loss: 0.01181
val explained_variance_score: 7.53 %
[17,    58] loss: 0.01126
[17,    58] beta loss: 2856935.39407
[17,   116] loss: 0.01112
[17,   116] beta loss: 2861091.51923
[17,   174] loss: 0.01078
[17,   174] beta loss: 2858935.41571
Time elapsed: 2h:3m:48s
train explained_variance_score: 11.82 %
val loss: 0.01337
val explained_variance_score: 1.84 %
[18,    58] loss: 0.01035
[18,    58] beta loss: 2857392.61441
[18,   116] loss: 0.01099
[18,   116] beta loss: 2857162.73932
[18,   174] loss: 0.01098
[18,   174] beta loss: 2877503.66857
Time elapsed: 2h:11m:25s
train explained_variance_score: 14.62 %
val loss: 0.01544
val explained_variance_score: 3.69 %
[19,    58] loss: 0.01068
[19,    58] beta loss: 2801795.37288
[19,   116] loss: 0.01091
[19,   116] beta loss: 2837494.51496
[19,   174] loss: 0.01031
[19,   174] beta loss: 2834643.29000
Time elapsed: 2h:17m:39s
train explained_variance_score: 18.88 %
val loss: 0.02613
val explained_variance_score: 1.84 %
[20,    58] loss: 0.00941
[20,    58] beta loss: 2889438.80085
[20,   116] loss: 0.00995
[20,   116] beta loss: 2866770.70940
[20,   174] loss: 0.01055
[20,   174] beta loss: 2858269.85857
Time elapsed: 2h:23m:59s
train explained_variance_score: 7.60 %
val loss: 0.01319
val explained_variance_score: 3.12 %
[21,    58] loss: 0.00993
[21,    58] beta loss: 2809530.22458
[21,   116] loss: 0.00988
[21,   116] beta loss: 2846456.14103
[21,   174] loss: 0.01033
[21,   174] beta loss: 2843071.79571
Time elapsed: 2h:30m:25s
train explained_variance_score: 19.37 %
val loss: 0.01244
val explained_variance_score: 5.25 %
[22,    58] loss: 0.01007
[22,    58] beta loss: 2807109.83051
[22,   116] loss: 0.00984
[22,   116] beta loss: 2830071.11752
[22,   174] loss: 0.01018
[22,   174] beta loss: 2833196.64000
Time elapsed: 2h:37m:2s
train explained_variance_score: 8.60 %
val loss: 0.01359
val explained_variance_score: 1.92 %
[23,    58] loss: 0.01031
[23,    58] beta loss: 2816036.23729
[23,   116] loss: 0.01028
[23,   116] beta loss: 2826873.46795
[23,   174] loss: 0.01016
[23,   174] beta loss: 2819873.69857
Time elapsed: 2h:43m:37s
train explained_variance_score: 25.45 %
val loss: 0.01306
val explained_variance_score: 4.12 %
[24,    58] loss: 0.01040
[24,    58] beta loss: 2812676.25000
[24,   116] loss: 0.00994
[24,   116] beta loss: 2818469.37393
[24,   174] loss: 0.00985
[24,   174] beta loss: 2813943.49429
Time elapsed: 2h:50m:10s
train explained_variance_score: 16.55 %
val loss: 0.01534
val explained_variance_score: -12.85 %
[25,    58] loss: 0.00865
[25,    58] beta loss: 2781749.11017
[25,   116] loss: 0.00930
[25,   116] beta loss: 2787132.33547
[25,   174] loss: 0.00958
[25,   174] beta loss: 2790925.49429
Time elapsed: 2h:56m:29s
train explained_variance_score: 19.13 %
val loss: 0.01305
val explained_variance_score: -2.33 %
[26,    58] loss: 0.00905
[26,    58] beta loss: 2788874.78814
[26,   116] loss: 0.00955
[26,   116] beta loss: 2793345.83120
[26,   174] loss: 0.00925
[26,   174] beta loss: 2790093.12286
Time elapsed: 3h:2m:53s
train explained_variance_score: 24.21 %
val loss: 0.01318
val explained_variance_score: -2.83 %
[27,    58] loss: 0.00830
[27,    58] beta loss: 2763915.65678
[27,   116] loss: 0.00890
[27,   116] beta loss: 2777672.88889
[27,   174] loss: 0.00883
[27,   174] beta loss: 2780492.08571
Time elapsed: 3h:9m:24s
train explained_variance_score: 15.12 %
val loss: 0.02566
val explained_variance_score: -11.29 %
[28,    58] loss: 0.00865
[28,    58] beta loss: 2758872.61441
[28,   116] loss: 0.00844
[28,   116] beta loss: 2755492.29701
[28,   174] loss: 0.00886
[28,   174] beta loss: 2753684.26000
Time elapsed: 3h:15m:30s
train explained_variance_score: 27.67 %
val loss: 0.01255
val explained_variance_score: 2.23 %
[29,    58] loss: 0.00831
[29,    58] beta loss: 2757555.97881
[29,   116] loss: 0.00875
[29,   116] beta loss: 2755995.89103
[29,   174] loss: 0.00865
[29,   174] beta loss: 2755963.18286
Time elapsed: 3h:21m:35s
train explained_variance_score: -0.53 %
val loss: 0.01409
val explained_variance_score: -5.96 %
[30,    58] loss: 0.00794
[30,    58] beta loss: 2736803.30932
[30,   116] loss: 0.00764
[30,   116] beta loss: 2733249.63889
[30,   174] loss: 0.00739
[30,   174] beta loss: 2729803.99571
Time elapsed: 3h:27m:39s
train explained_variance_score: 41.91 %
val loss: 0.01378
val explained_variance_score: -5.37 %
[31,    58] loss: 0.00633
[31,    58] beta loss: 2711040.83475
[31,   116] loss: 0.00638
[31,   116] beta loss: 2716441.95085
[31,   174] loss: 0.00649
[31,   174] beta loss: 2720557.80714
Time elapsed: 3h:33m:45s
train explained_variance_score: 52.57 %
val loss: 0.01386
val explained_variance_score: -8.54 %
Early stopping with window mode at epoch 31.
Best results were achieved at epoch 16 with val metric score = 0.01181381454305916.
Best window of size 2 achieved a mean result of 0.012593151040070145 and started at epoch 16.
Total time elapsed: 3h:34m:26s
Writing model to disk...
----------------------
Re-evaluatiing on validation data: 
----------------------
eval loss: 0.01386
eval explained_variance_score: -8.54 %
----------------------
Evaluation on holdout data: 
----------------------
eval loss: 159683.99816
eval explained_variance_score: 0.03 %
---------------- CNNpipeline completed ----------------
RAN FOR 3:40:20s
