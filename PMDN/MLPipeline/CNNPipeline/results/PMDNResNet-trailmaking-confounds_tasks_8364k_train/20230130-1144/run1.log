START_TIME 	 15:46::45
dataset loaded successfully in 7m:46s..
Starting CNN_PIPELINE() with:                
{'run_id': 'run1', 'model': 'PMDNResNet50DeepRepViz', 'model_params': {'dataset_size': 8364, 'batch_size': 24, 'task_type': 'classif_binary', 'out_classes': 1, 'debug_print': True, 'pretrained_model': '/ritter/share/data/UKBB_2020/trained_model/r3d50_K_200ep.pth'}, 'model_unique_name': 'PMDN_trailmaking', 'inp': 'X', 'out': 'trail_making_avg_duration', 'n_samples': 8364, 'm__batch_size': 24, 'm__num_epochs': 120, 'm__criterion': 'MSELoss({})', 'm__optimizer': "Adam({'lr': 0.0005, 'weight_decay': 0.0001})", 'm__scheduler': "StepLR({'step_size': 20, 'gamma': 0.1})", 'm__augmentations': ['SagittalFlip', 'SagittalTranslate'], 'm__earlystop_patience': 15}                
output_dir: /ritter/share/projects/gonzalo/thesis/PMDN/MLPipeline/CNNPipeline/results//PMDNResNet-trailmaking-confounds_tasks_8364k_train/20230130-1144                
using GPU:  cuda:1                 
---------------- CNNpipeline starting ----------------
###############hi############
:: m__n_params:    47122385
[0,    58] loss: 0.01126
[0,    58] beta loss: 2749423.94068
[0,   116] loss: 0.01061
[0,   116] beta loss: 2748426.92949
[0,   174] loss: 0.01089
[0,   174] beta loss: 2741755.45286
Time elapsed: 0h:5m:18s
train explained_variance_score: 20.87 %
val loss: 0.00873
val explained_variance_score: 32.99 %
[1,    58] loss: 0.01078
[1,    58] beta loss: 2711767.58475
[1,   116] loss: 0.01137
[1,   116] beta loss: 2694093.83120
[1,   174] loss: 0.01065
[1,   174] beta loss: 2685056.26000
Time elapsed: 0h:11m:13s
train explained_variance_score: 28.61 %
val loss: 0.00997
val explained_variance_score: 22.61 %
[2,    58] loss: 0.01060
[2,    58] beta loss: 2610494.35593
[2,   116] loss: 0.01019
[2,   116] beta loss: 2612728.89530
[2,   174] loss: 0.00980
[2,   174] beta loss: 2613550.84857
Time elapsed: 0h:17m:8s
train explained_variance_score: 25.36 %
val loss: 0.01003
val explained_variance_score: 27.91 %
[3,    58] loss: 0.00909
[3,    58] beta loss: 2534792.18644
[3,   116] loss: 0.00972
[3,   116] beta loss: 2567614.12179
[3,   174] loss: 0.00950
[3,   174] beta loss: 2560504.24286
Time elapsed: 0h:23m:0s
train explained_variance_score: 32.56 %
val loss: 0.00961
val explained_variance_score: 24.21 %
[4,    58] loss: 0.00942
[4,    58] beta loss: 2443247.43644
[4,   116] loss: 0.00951
[4,   116] beta loss: 2433085.76068
[4,   174] loss: 0.00961
[4,   174] beta loss: 2423235.74429
Time elapsed: 0h:28m:54s
train explained_variance_score: 22.32 %
val loss: 0.01117
val explained_variance_score: 19.82 %
[5,    58] loss: 0.00981
[5,    58] beta loss: 2365039.07415
[5,   116] loss: 0.00890
[5,   116] beta loss: 2388115.03953
[5,   174] loss: 0.00844
[5,   174] beta loss: 2394764.65500
Time elapsed: 0h:34m:48s
train explained_variance_score: 44.29 %
val loss: 0.00948
val explained_variance_score: 25.52 %
[6,    58] loss: 0.00756
[6,    58] beta loss: 2380511.72246
[6,   116] loss: 0.00800
[6,   116] beta loss: 2345059.85150
[6,   174] loss: 0.00824
[6,   174] beta loss: 2337832.76643
Time elapsed: 0h:40m:41s
train explained_variance_score: 12.21 %
val loss: 0.01011
val explained_variance_score: 20.65 %
[7,    58] loss: 0.00765
[7,    58] beta loss: 2291048.19703
[7,   116] loss: 0.00785
[7,   116] beta loss: 2277655.41239
[7,   174] loss: 0.00782
[7,   174] beta loss: 2274169.51143
Time elapsed: 0h:46m:51s
train explained_variance_score: 52.63 %
val loss: 0.01321
val explained_variance_score: 14.71 %
[8,    58] loss: 0.00760
[8,    58] beta loss: 2255683.79449
[8,   116] loss: 0.00722
[8,   116] beta loss: 2256265.46261
[8,   174] loss: 0.00741
[8,   174] beta loss: 2258881.25786
Time elapsed: 0h:52m:59s
train explained_variance_score: 28.63 %
val loss: 0.01292
val explained_variance_score: 14.57 %
[9,    58] loss: 0.00740
[9,    58] beta loss: 2288508.31356
[9,   116] loss: 0.00733
[9,   116] beta loss: 2258809.58226
[9,   174] loss: 0.00733
[9,   174] beta loss: 2234990.34571
Time elapsed: 0h:59m:4s
train explained_variance_score: 48.62 %
val loss: 0.01156
val explained_variance_score: 21.56 %
[10,    58] loss: 0.00664
[10,    58] beta loss: 2180883.20975
[10,   116] loss: 0.00663
[10,   116] beta loss: 2182238.28739
[10,   174] loss: 0.00685
[10,   174] beta loss: 2176814.34429
Time elapsed: 1h:5m:5s
train explained_variance_score: 40.93 %
val loss: 0.01051
val explained_variance_score: 16.65 %
[11,    58] loss: 0.00680
[11,    58] beta loss: 2084608.12924
[11,   116] loss: 0.00653
[11,   116] beta loss: 2081182.71154
[11,   174] loss: 0.00650
[11,   174] beta loss: 2070046.98500
Time elapsed: 1h:11m:8s
train explained_variance_score: 43.22 %
val loss: 0.01044
val explained_variance_score: 17.76 %
[12,    58] loss: 0.00614
[12,    58] beta loss: 2028669.04237
[12,   116] loss: 0.00606
[12,   116] beta loss: 2035852.74786
[12,   174] loss: 0.00604
[12,   174] beta loss: 2045930.86714
Time elapsed: 1h:17m:8s
train explained_variance_score: 38.33 %
val loss: 0.01091
val explained_variance_score: 18.43 %
[13,    58] loss: 0.00653
[13,    58] beta loss: 2028459.68008
[13,   116] loss: 0.00678
[13,   116] beta loss: 2031050.14316
[13,   174] loss: 0.00664
[13,   174] beta loss: 2031611.08714
Time elapsed: 1h:23m:7s
train explained_variance_score: 27.26 %
val loss: 0.01001
val explained_variance_score: 20.58 %
[14,    58] loss: 0.00556
[14,    58] beta loss: 1980636.69280
[14,   116] loss: 0.00590
[14,   116] beta loss: 1969356.73932
[14,   174] loss: 0.00600
[14,   174] beta loss: 1971709.29071
Time elapsed: 1h:29m:5s
train explained_variance_score: 55.10 %
val loss: 0.01132
val explained_variance_score: 14.55 %
[15,    58] loss: 0.00545
[15,    58] beta loss: 1899570.72669
[15,   116] loss: 0.00526
[15,   116] beta loss: 1901124.33974
[15,   174] loss: 0.00538
[15,   174] beta loss: 1891462.19786
Time elapsed: 1h:35m:3s
train explained_variance_score: 61.39 %
val loss: 0.01066
val explained_variance_score: 15.90 %
[16,    58] loss: 0.00579
[16,    58] beta loss: 1780771.90890
[16,   116] loss: 0.00583
[16,   116] beta loss: 1763108.41346
[16,   174] loss: 0.00554
[16,   174] beta loss: 1739489.11286
Time elapsed: 1h:41m:2s
train explained_variance_score: 58.62 %
val loss: 0.01117
val explained_variance_score: 17.60 %
[17,    58] loss: 0.00490
[17,    58] beta loss: 1599482.59322
[17,   116] loss: 0.00506
[17,   116] beta loss: 1597200.80876
[17,   174] loss: 0.00520
[17,   174] beta loss: 1601632.56500
Time elapsed: 1h:47m:5s
train explained_variance_score: 54.78 %
val loss: 0.04299
val explained_variance_score: -36.30 %
[18,    58] loss: 0.00508
[18,    58] beta loss: 1607091.63559
[18,   116] loss: 0.00492
[18,   116] beta loss: 1604154.92201
[18,   174] loss: 0.00496
[18,   174] beta loss: 1596797.79143
Time elapsed: 1h:53m:11s
train explained_variance_score: 52.34 %
val loss: 0.01257
val explained_variance_score: 20.19 %
[19,    58] loss: 0.00527
[19,    58] beta loss: 1552403.22246
[19,   116] loss: 0.00523
[19,   116] beta loss: 1540742.53419
[19,   174] loss: 0.00510
[19,   174] beta loss: 1514962.69143
Time elapsed: 1h:59m:24s
train explained_variance_score: 57.38 %
val loss: 0.01023
val explained_variance_score: 19.06 %
[20,    58] loss: 0.00478
[20,    58] beta loss: 1453805.16525
[20,   116] loss: 0.00479
[20,   116] beta loss: 1433879.83868
[20,   174] loss: 0.00455
[20,   174] beta loss: 1428895.35571
Time elapsed: 2h:5m:37s
train explained_variance_score: 59.60 %
val loss: 0.01075
val explained_variance_score: 15.01 %
[21,    58] loss: 0.00438
[21,    58] beta loss: 1423257.46186
[21,   116] loss: 0.00439
[21,   116] beta loss: 1376880.69444
[21,   174] loss: 0.00457
[21,   174] beta loss: 1363770.74214
Time elapsed: 2h:11m:45s
train explained_variance_score: 49.23 %
val loss: 0.01172
val explained_variance_score: 17.40 %
[22,    58] loss: 0.00352
[22,    58] beta loss: 1411719.79237
[22,   116] loss: 0.00419
[22,   116] beta loss: 1389057.72650
[22,   174] loss: 0.00415
[22,   174] beta loss: 1385226.06857
Time elapsed: 2h:17m:57s
train explained_variance_score: 79.36 %
val loss: 0.01641
val explained_variance_score: 15.43 %
[23,    58] loss: 0.00412
[23,    58] beta loss: 1380107.62712
[23,   116] loss: 0.00444
[23,   116] beta loss: 1368323.17415
[23,   174] loss: 0.00438
[23,   174] beta loss: 1357060.78429
Time elapsed: 2h:24m:4s
train explained_variance_score: 13.25 %
val loss: 0.01270
val explained_variance_score: 16.19 %
[24,    58] loss: 0.00334
[24,    58] beta loss: 1298633.49364
[24,   116] loss: 0.00353
[24,   116] beta loss: 1308507.19338
[24,   174] loss: 0.00384
[24,   174] beta loss: 1311384.89143
Time elapsed: 2h:30m:11s
train explained_variance_score: 78.75 %
val loss: 0.01126
val explained_variance_score: 12.48 %
[25,    58] loss: 0.00414
[25,    58] beta loss: 1298284.26271
[25,   116] loss: 0.00404
[25,   116] beta loss: 1312885.38355
[25,   174] loss: 0.00417
[25,   174] beta loss: 1326310.33000
Time elapsed: 2h:36m:19s
train explained_variance_score: 61.89 %
val loss: 0.01169
val explained_variance_score: 10.74 %
[26,    58] loss: 0.00357
[26,    58] beta loss: 1337610.41949
[26,   116] loss: 0.00362
[26,   116] beta loss: 1338797.05983
[26,   174] loss: 0.00354
[26,   174] beta loss: 1336718.75786
Time elapsed: 2h:42m:26s
train explained_variance_score: 61.65 %
val loss: 0.01113
val explained_variance_score: 12.21 %
[27,    58] loss: 0.00376
[27,    58] beta loss: 1275774.77754
[27,   116] loss: 0.00370
[27,   116] beta loss: 1286749.78953
[27,   174] loss: 0.00369
[27,   174] beta loss: 1296084.60286
Time elapsed: 2h:48m:33s
train explained_variance_score: 72.99 %
val loss: 0.01942
val explained_variance_score: -4.73 %
[28,    58] loss: 0.00318
[28,    58] beta loss: 1277020.53602
[28,   116] loss: 0.00324
[28,   116] beta loss: 1268302.02778
[28,   174] loss: 0.00352
[28,   174] beta loss: 1276392.16786
Time elapsed: 2h:54m:39s
train explained_variance_score: 67.44 %
val loss: 0.01179
val explained_variance_score: 6.45 %
[29,    58] loss: 0.00322
[29,    58] beta loss: 1274162.15254
[29,   116] loss: 0.00340
[29,   116] beta loss: 1275800.41880
[29,   174] loss: 0.00349
[29,   174] beta loss: 1274345.33143
Time elapsed: 3h:0m:47s
train explained_variance_score: 77.40 %
val loss: 0.01117
val explained_variance_score: 11.40 %
[30,    58] loss: 0.00297
[30,    58] beta loss: 1225178.50424
[30,   116] loss: 0.00284
[30,   116] beta loss: 1219679.20833
[30,   174] loss: 0.00283
[30,   174] beta loss: 1222451.58357
Time elapsed: 3h:6m:51s
train explained_variance_score: 82.85 %
val loss: 0.01128
val explained_variance_score: 10.92 %
[31,    58] loss: 0.00221
[31,    58] beta loss: 1217596.64195
[31,   116] loss: 0.00231
[31,   116] beta loss: 1218155.75748
[31,   174] loss: 0.00234
[31,   174] beta loss: 1219480.23571
Time elapsed: 3h:13m:2s
train explained_variance_score: 79.37 %
val loss: 0.01140
val explained_variance_score: 9.88 %
[32,    58] loss: 0.00216
[32,    58] beta loss: 1228046.00424
[32,   116] loss: 0.00224
[32,   116] beta loss: 1223565.08761
[32,   174] loss: 0.00225
[32,   174] beta loss: 1225517.47857
Time elapsed: 3h:19m:14s
train explained_variance_score: 81.65 %
val loss: 0.01138
val explained_variance_score: 10.19 %
[33,    58] loss: 0.00227
[33,    58] beta loss: 1229805.88559
[33,   116] loss: 0.00221
[33,   116] beta loss: 1232281.39957
[33,   174] loss: 0.00229
[33,   174] beta loss: 1234037.58857
Time elapsed: 3h:25m:22s
train explained_variance_score: 81.95 %
val loss: 0.01158
val explained_variance_score: 8.40 %
[34,    58] loss: 0.00217
[34,    58] beta loss: 1226771.26907
[34,   116] loss: 0.00210
[34,   116] beta loss: 1229308.59188
[34,   174] loss: 0.00205
[34,   174] beta loss: 1229118.47643
Time elapsed: 3h:31m:36s
train explained_variance_score: 79.15 %
val loss: 0.01139
val explained_variance_score: 9.58 %
Early stopping with window mode at epoch 34.
Best results were achieved at epoch 19 with val metric score = 0.010230465135777947.
Best window of size 2 achieved a mean result of 0.01049080176343178 and started at epoch 19.
Total time elapsed: 3h:32m:18s
Writing model to disk...
----------------------
Re-evaluatiing on validation data: 
----------------------
eval loss: 0.01139
eval explained_variance_score: 9.58 %
----------------------
Evaluation on holdout data: 
----------------------
eval loss: 159682.19265
eval explained_variance_score: 0.02 %
---------------- CNNpipeline completed ----------------
RAN FOR 3:42:49s
