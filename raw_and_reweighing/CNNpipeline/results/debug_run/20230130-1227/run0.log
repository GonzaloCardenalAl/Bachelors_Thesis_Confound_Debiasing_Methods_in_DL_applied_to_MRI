START_TIME 	 12:27::53
[DEBUG] using only 50 data points
dataset loaded successfully in 0m:30s..
Running weigh debiasing method for sex as a confound
Weights for imbalanced data bias were created...
tensor([0.8100, 0.5855, 1.3800, 0.5855, 0.8100, 1.3800, 0.8100, 0.8100, 0.8100,
        0.5855, 0.8100, 0.8100, 0.8100, 1.3800, 0.8100, 0.5855, 1.3800, 1.3800,
        0.8100, 0.8100, 1.3800, 0.5855, 2.5200, 1.3800, 0.5855, 0.5855, 0.5855,
        0.8100, 0.5855, 1.3800, 0.5855, 0.8100, 0.8100, 0.8100, 0.8100, 0.8100,
        2.5200, 1.3800, 0.8100, 1.3800, 1.3800, 0.8100, 0.8100, 0.8100, 0.8100,
        1.3800, 2.5200, 0.8100, 0.5855, 0.8100], dtype=torch.float64) torch.Size([50])
Starting CNN_PIPELINE() with:                
{'run_id': 'run0', 'model': 'ResNet50DeepRepViz', 'model_params': {'out_classes': 1, 'task_type': 'classif_binary', 'freeze_feature_extractor': False, 'pretrained_model': '/ritter/share/data/UKBB_2020/trained_model/r3d50_K_200ep.pth'}, 'model_unique_name': 'ResNet50_alc_binary', 'inp': 'X', 'out': 'highalc', 'n_samples': 50, 'm__batch_size': 4, 'm__num_epochs': 5, 'm__criterion': "BCEWithLogitsLoss({'reduction': 'mean'})", 'm__optimizer': "Adam({'lr': 0.0005, 'weight_decay': 0.0001})", 'm__scheduler': "StepLR({'step_size': 20, 'gamma': 0.1})", 'm__augmentations': ['SagittalFlip', 'SagittalTranslate'], 'm__earlystop_patience': 0}                
output_dir: /ritter/share/projects/gonzalo/thesis/ML_for_alcohol_misuse/CNNpipeline/results//debug_run/20230130-1227                
using GPU:  cuda:3                 
---------------- CNNpipeline starting ----------------
:: m__n_params:    48205073
Adjusting learning rate of group 0 to 5.0000e-04.
DEBUG 328 (tensor([-0.0060, -0.0312, -0.0056,  0.0031], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 1., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-2.9936, -2.9881, -2.9253, -2.9187], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([1., 1., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-2.2394, -2.1511, -3.2265, -3.4003], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 1.], device='cuda:3'), torch.Size([4]))
[0,     2] loss: 0.73081
DEBUG 328 (tensor([-1.6184, -2.7756, -2.1298, -2.1931], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([1., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.7354, -1.4317, -1.4700, -3.2320], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 1., 0.], device='cuda:3'), torch.Size([4]))
[0,     4] loss: 0.58083
DEBUG 328 (tensor([-0.4881, -1.1217, -2.4316, -1.5242], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 1., 1.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.8614, -0.7180, -0.9400, -0.8823], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 1., 0.], device='cuda:3'), torch.Size([4]))
[0,     6] loss: 0.69399
DEBUG 328 (tensor([-0.0617, -0.2188, -0.1802, -0.0464], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 1., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([ 0.0075, -0.1327,  0.1139, -0.0641], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 1.], device='cuda:3'), torch.Size([4]))
[0,     8] loss: 0.71523
DEBUG 328 (tensor([ 0.1186, -0.1019,  0.0638,  0.3514], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 1.], device='cuda:3'), torch.Size([4]))
Time elapsed: 0h:0m:5s
train balanced_accuracy_score: 40.00 %
train accuracy_score: 60.00 %
train mz_rsquare: 28.99 %
DEBUG LINE 390 (tensor([-0.1635, -0.2133, -0.2271, -0.1989], device='cuda:3'), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG LINE 390 (tensor([-0.2213, -0.2095, -0.1920, -0.2304], device='cuda:3'), torch.Size([4]), tensor([0., 0., 1., 0.], device='cuda:3'), torch.Size([4]))
DEBUG LINE 390 (tensor([-0.1694, -0.2241], device='cuda:3'), torch.Size([2]), tensor([1., 0.], device='cuda:3'), torch.Size([2]))
val loss: 0.64083
val balanced_accuracy_score: 50.00 %
val accuracy_score: 80.00 %
val mz_rsquare: 0.02 %
Adjusting learning rate of group 0 to 5.0000e-04.
DEBUG 328 (tensor([ 0.5238, -0.5149, -0.2451, -0.0577], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([1., 0., 1., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([ 0.8059, -0.6877, -0.4859, -0.7104], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 1., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.5861, -0.1291, -1.3332, -0.4778], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 1.], device='cuda:3'), torch.Size([4]))
[1,     2] loss: 0.59055
DEBUG 328 (tensor([-1.4812, -1.4161, -1.1188, -0.5777], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 1., 1., 1.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.9343, -0.1951, -1.3878, -1.8792], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 1., 1., 0.], device='cuda:3'), torch.Size([4]))
[1,     4] loss: 0.67403
DEBUG 328 (tensor([-1.6561, -1.3022, -1.2042,  0.0583], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.6091, -1.1335, -1.8067, -0.8367], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 1., 1., 0.], device='cuda:3'), torch.Size([4]))
[1,     6] loss: 0.74191
DEBUG 328 (tensor([-1.1591, -1.0436, -0.7309, -0.7632], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 1.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.8828, -1.1363, -0.5434, -0.6825], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
[1,     8] loss: 0.65101
DEBUG 328 (tensor([-0.6766, -1.0063, -0.8386, -0.9726], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
Time elapsed: 0h:0m:7s
train balanced_accuracy_score: 57.14 %
train accuracy_score: 70.00 %
train mz_rsquare: 9.32 %
DEBUG LINE 390 (tensor([-0.6928, -0.8701, -0.8027, -0.8470], device='cuda:3'), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG LINE 390 (tensor([-0.8566, -0.8548, -0.9045, -1.0736], device='cuda:3'), torch.Size([4]), tensor([0., 0., 1., 0.], device='cuda:3'), torch.Size([4]))
DEBUG LINE 390 (tensor([-0.9822, -1.0228], device='cuda:3'), torch.Size([2]), tensor([1., 0.], device='cuda:3'), torch.Size([2]))
val loss: 0.57867
val balanced_accuracy_score: 50.00 %
val accuracy_score: 80.00 %
val mz_rsquare: 0.34 %
Adjusting learning rate of group 0 to 5.0000e-04.
DEBUG 328 (tensor([-1.1143, -0.7756, -1.2104, -1.2759], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-1.2817, -1.6613, -1.2533, -1.4835], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 1., 1., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-1.1910, -1.9431, -1.6425, -1.7112], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
[2,     2] loss: 0.38091
DEBUG 328 (tensor([-1.9878, -1.8608, -2.0685, -1.9690], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 1.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-2.1619, -2.4702, -2.1194, -2.2714], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([1., 0., 0., 1.], device='cuda:3'), torch.Size([4]))
[2,     4] loss: 0.45881
DEBUG 328 (tensor([-2.4939, -2.2692, -2.2257, -2.4032], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 1.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-2.6356, -2.2730, -2.1863, -2.3578], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
[2,     6] loss: 0.40059
DEBUG 328 (tensor([-2.5578, -2.4638, -2.3893, -2.4272], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 1., 1.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-2.2175, -1.8842, -1.9735, -2.1772], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 1., 0., 1.], device='cuda:3'), torch.Size([4]))
[2,     8] loss: 0.71353
DEBUG 328 (tensor([-1.1903, -1.5865, -1.6019, -1.7642], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 1., 1., 0.], device='cuda:3'), torch.Size([4]))
Time elapsed: 0h:0m:9s
train balanced_accuracy_score: 50.00 %
train accuracy_score: 80.00 %
train mz_rsquare: 7.17 %
DEBUG LINE 390 (tensor([-1.0422, -1.1676, -1.1562, -1.1505], device='cuda:3'), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG LINE 390 (tensor([-1.1981, -1.1851, -1.1428, -1.1745], device='cuda:3'), torch.Size([4]), tensor([0., 0., 1., 0.], device='cuda:3'), torch.Size([4]))
DEBUG LINE 390 (tensor([-1.1380, -1.2561], device='cuda:3'), torch.Size([2]), tensor([1., 0.], device='cuda:3'), torch.Size([2]))
val loss: 0.55616
val balanced_accuracy_score: 50.00 %
val accuracy_score: 80.00 %
val mz_rsquare: 0.08 %
Adjusting learning rate of group 0 to 5.0000e-04.
DEBUG 328 (tensor([-1.4324, -0.8341, -0.9669, -0.8944], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.6515, -0.7500, -0.6802, -0.9876], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([1., 0., 1., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.6060, -0.3547, -0.3443, -0.4613], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([1., 1., 0., 1.], device='cuda:3'), torch.Size([4]))
[3,     2] loss: 0.62732
DEBUG 328 (tensor([-0.3457, -0.0965, -0.0704, -0.2155], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.0843,  0.0272, -0.0851, -0.1058], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([1., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
[3,     4] loss: 0.70408
DEBUG 328 (tensor([ 0.0397,  0.0099,  0.0797, -0.0060], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([1., 0., 0., 1.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([ 0.1513, -0.0620,  0.1086,  0.0804], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 1., 0., 0.], device='cuda:3'), torch.Size([4]))
[3,     6] loss: 0.68400
DEBUG 328 (tensor([-0.0267,  0.1630,  0.0514,  0.0574], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 1., 1., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([ 0.0443, -0.0063,  0.0054,  0.0945], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
[3,     8] loss: 0.66012
DEBUG 328 (tensor([-0.1983, -0.0358, -0.1397, -0.0067], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([1., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
Time elapsed: 0h:0m:11s
train balanced_accuracy_score: 26.67 %
train accuracy_score: 40.00 %
train mz_rsquare: 5.39 %
DEBUG LINE 390 (tensor([-0.3038, -0.3813, -0.3826, -0.3648], device='cuda:3'), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG LINE 390 (tensor([-0.3957, -0.3878, -0.3760, -0.3878], device='cuda:3'), torch.Size([4]), tensor([0., 0., 1., 0.], device='cuda:3'), torch.Size([4]))
DEBUG LINE 390 (tensor([-0.3887, -0.4067], device='cuda:3'), torch.Size([2]), tensor([1., 0.], device='cuda:3'), torch.Size([2]))
val loss: 0.61693
val balanced_accuracy_score: 50.00 %
val accuracy_score: 80.00 %
val mz_rsquare: 0.02 %
Adjusting learning rate of group 0 to 5.0000e-04.
DEBUG 328 (tensor([-0.2070, -0.2084, -0.3292, -0.2186], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 1.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.3848, -0.4697, -0.3545, -0.4369], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 1., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.5461, -0.6789, -0.4980, -0.5448], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 1., 0.], device='cuda:3'), torch.Size([4]))
[4,     2] loss: 0.65532
DEBUG 328 (tensor([-0.7331, -0.7099, -0.8349, -0.6068], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([1., 1., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.8273, -0.8503, -1.1956, -0.7393], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 1.], device='cuda:3'), torch.Size([4]))
[4,     4] loss: 0.58158
DEBUG 328 (tensor([-1.2050, -1.2869, -0.7495, -0.9483], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 1.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-0.8959, -1.0092, -1.6688, -1.5234], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 1., 1., 0.], device='cuda:3'), torch.Size([4]))
[4,     6] loss: 0.64871
DEBUG 328 (tensor([-1.6671, -1.2716, -0.9050, -1.2435], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([1., 1., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG 328 (tensor([-1.5399, -1.1528, -1.0259, -0.8996], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 1., 0., 0.], device='cuda:3'), torch.Size([4]))
[4,     8] loss: 0.62716
DEBUG 328 (tensor([-0.9915, -1.2098, -1.1261, -1.6168], device='cuda:3',
       grad_fn=<SqueezeBackward0>), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
Time elapsed: 0h:0m:13s
train balanced_accuracy_score: 50.00 %
train accuracy_score: 70.00 %
train mz_rsquare: 5.34 %
DEBUG LINE 390 (tensor([-2.3348, -3.9631, -4.5905, -3.0719], device='cuda:3'), torch.Size([4]), tensor([0., 0., 0., 0.], device='cuda:3'), torch.Size([4]))
DEBUG LINE 390 (tensor([-4.6197, -4.6185, -3.9071, -4.6777], device='cuda:3'), torch.Size([4]), tensor([0., 0., 1., 0.], device='cuda:3'), torch.Size([4]))
DEBUG LINE 390 (tensor([-3.9599, -5.6134], device='cuda:3'), torch.Size([2]), tensor([1., 0.], device='cuda:3'), torch.Size([2]))
val loss: 1.00727
val balanced_accuracy_score: 50.00 %
val accuracy_score: 80.00 %
val mz_rsquare: 18.84 %
Adjusting learning rate of group 0 to 5.0000e-04.
Total time elapsed: 0h:0m:25s
Writing model to disk...
----------------------
Re-evaluatiing on validation data: 
----------------------
eval loss: 1.00727
eval balanced_accuracy_score: 50.00 %
eval accuracy_score: 80.00 %
eval mz_rsquare: 18.84 %
---------------- CNNpipeline completed ----------------
RAN FOR 0:01:01s
